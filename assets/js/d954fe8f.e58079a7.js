"use strict";(globalThis.webpackChunkrc_knob_docs=globalThis.webpackChunkrc_knob_docs||[]).push([[880],{2082(e,t,n){n.r(t),n.d(t,{Marker:()=>u,assets:()=>d,contentTitle:()=>c,default:()=>p,frontMatter:()=>l,metadata:()=>a,toc:()=>g});const a=JSON.parse('{"id":"intro","title":"Introduction","description":"Renders a react knob component that can be widely customised.","source":"@site/docs/0_intro.mdx","sourceDirName":".","slug":"/","permalink":"/rc-knob/","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":0,"frontMatter":{"slug":"/","sidebar_position":0,"title":"Introduction"},"sidebar":"tutorialSidebar","next":{"title":"Base components","permalink":"/rc-knob/base_components"}}');var r=n(7900),s=n(3943),o=n(2772),i=n(3045);const l={slug:"/",sidebar_position:0,title:"Introduction"},c=void 0,d={},u=({angle:e})=>(0,r.jsx)(r.Fragment,{}),g=[{value:"<code>Knob</code>",id:"knob",level:2},{value:"Value",id:"value",level:3},{value:"Geometry",id:"geometry",level:3},{value:"Anticlockwise",id:"anticlockwise",level:3}];function h(e){const t={code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.p,{children:"Renders a react knob component that can be widely customised."}),"\n",(0,r.jsxs)(i.N6,{size:100,angleOffset:220,angleRange:280,value:33,min:0,max:100,children:[(0,r.jsx)(i.l5,{arcWidth:5,color:o.A.primary,background:o.A.shadow}),(0,r.jsx)(i.gm,{width:5,height:40,radius:10,type:"rect",color:o.A.primary})]}),"\n",(0,r.jsx)(t.p,{children:"The base of all knobs is the Knob component which handles all of the user\ninteraction and calculation of the knob value. The user can interact via\ndrag'n drop, mousewheel and keyboard. The knobs are accessible by the tab key."}),"\n",(0,r.jsxs)(t.p,{children:["The display part is splitted into the ",(0,r.jsx)(t.code,{children:"Pointer"}),", ",(0,r.jsx)(t.code,{children:"Scale"}),", ",(0,r.jsx)(t.code,{children:"Arc"}),", ",(0,r.jsx)(t.code,{children:"Value"}),"\nand few others."]}),"\n",(0,r.jsx)(t.p,{children:"One or more of them can be children of a Knob."}),"\n",(0,r.jsx)(t.h2,{id:"knob",children:(0,r.jsx)(t.code,{children:"Knob"})}),"\n",(0,r.jsxs)(t.p,{children:["The ",(0,r.jsx)(t.code,{children:"Knob"})," component is root component that handles all the user interactions."]}),"\n",(0,r.jsxs)(t.p,{children:["It does not render any visual UI elements but a ",(0,r.jsx)(t.code,{children:"<div><svg></svg></div>"}),"."]}),"\n",(0,r.jsxs)(t.p,{children:["All children will be added to the ",(0,r.jsx)(t.code,{children:"<svg>"})," element."]}),"\n",(0,r.jsxs)(t.p,{children:["It handles the user interaction by mouse, mouse wheel and keyboard arrow keys.\nIt is accessible by keyboard using ",(0,r.jsx)(t.code,{children:"tab"}),"."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-js",metastring:"static",children:"<Knob \n  size={100}  \n  angleOffset={220} \n  angleRange={280}\n  value={33}\n  min={0}\n  max={100}\n>\n  ...\n</Knob>\n"})}),"\n",(0,r.jsx)(t.h3,{id:"value",children:"Value"}),"\n",(0,r.jsxs)(t.p,{children:["The knob hold a numeric ",(0,r.jsx)(t.code,{children:"value"}),". This value is constained between ",(0,r.jsx)(t.code,{children:"min"})," and\n",(0,r.jsx)(t.code,{children:"max"}),"."]}),"\n",(0,r.jsx)(t.h3,{id:"geometry",children:"Geometry"}),"\n",(0,r.jsxs)(t.p,{children:["The ",(0,r.jsx)(t.code,{children:"size"})," is the diameter of the knob."]}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.code,{children:"angleOffset"})," and ",(0,r.jsx)(t.code,{children:"angleRange"})," are used to define the knob geometry."]}),"\n",(0,r.jsx)(t.p,{children:"It is relative to the top of the knob, and clockwise."}),"\n","\n",(0,r.jsxs)(i.N6,{size:150,angleOffset:0,angleRange:360,min:0,max:100,children:[(0,r.jsx)(i.gm,{percentage:0,width:5,height:30,radius:0,type:"rect",color:o.A.primary}),(0,r.jsx)(i.JU,{percentage:0,radius:50,label:"0 deg",style:{fontSize:"80%"}}),(0,r.jsx)(i.gm,{percentage:140/360,width:5,height:30,radius:0,type:"rect",color:o.A.primary}),(0,r.jsx)(i.JU,{percentage:140/360,radius:50,label:"140 deg",style:{fontSize:"80%"}}),(0,r.jsx)(i.gm,{percentage:220/360,width:5,height:30,radius:0,type:"rect",color:o.A.primary}),(0,r.jsx)(i.JU,{percentage:220/360,radius:50,label:"220 deg",style:{fontSize:"80%"}}),(0,r.jsx)(i.Q6,{radius:30,arcWidth:5,color:o.A.primary,percentageFrom:0,percentageTo:.5}),(0,r.jsx)(i.Q6,{radius:30,arcWidth:5,color:o.A.primary,percentageFrom:.5,percentageTo:1})]}),"\n",(0,r.jsx)(t.h3,{id:"anticlockwise",children:"Anticlockwise"}),"\n",(0,r.jsxs)(t.p,{children:["If ",(0,r.jsx)(t.code,{children:"angleRange"})," is negative, the interaction is anticlockwise."]}),"\n",(0,r.jsxs)(i.N6,{size:100,angleOffset:140,angleRange:-280,value:33,min:0,max:100,children:[(0,r.jsx)(i.l5,{arcWidth:5,color:o.A.primary,background:o.A.shadow}),(0,r.jsx)(i.gm,{width:5,height:40,radius:10,type:"rect",color:o.A.primary})]})]})}function p(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},2772(e,t,n){n.d(t,{A:()=>a});const a={primary:"#FC5A96",secondary:"#180094",shadow:"#CCCCCC"}},3045(e,t,n){n.d(t,{An:()=>M,FE:()=>w,JU:()=>R,N6:()=>E,Q6:()=>y,WT:()=>$,gm:()=>k,l5:()=>j});var a=n(7900),r=n(2128);const s=(e,t,n)=>Math.max(e,Math.min(t,n)),o=({mouseAngle:e,angleOffset:t,angleRange:n})=>s(0,1,.5+((e-(t+.5*n)+900)%360-180)/n),i=({mouseAngle:e,multiRotation:t,angleOffset:n,angleRange:a,percentage:r,previousPercentage:s,previousMouseAngle:i})=>{if(null!==i){const r=(e-i)%360,o=r>180?-(360-r):r<-180?360+r:r;if(o>=120||o<=-120)return{updated:!1,mouseAngle:i,percentage:s};const l=s+o/a;if(!t&&(l<0||l>1)){return{updated:!0,mouseAngle:l<0?n:(n+a+720)%360,percentage:l<0?0:1}}return{updated:!0,mouseAngle:e,percentage:l}}if(t){const t=(o({angleOffset:n,angleRange:a,mouseAngle:e})+1-r%1)%1;return{updated:!0,mouseAngle:e,percentage:r+(t>.5?t-1:t)}}return{updated:!0,mouseAngle:e,percentage:o({angleOffset:n,angleRange:a,mouseAngle:e})}},l=(e,t,n)=>{if(!e.updated||!n)return e;const a=c(e.percentage,n),r=(t.angleOffset+t.angleRange*a)%360;return{...e,percentage:a,mouseAngle:r<0?r+360:r}},c=(e,t)=>{if(0===e)return 0;const n=Math.sign(e),a=Math.abs(e),r=1/t;return n*(a-.5*r)+n*(r-(a+.5*r)%r)},d=({min:e,max:t,percentage:n})=>e+(t-e)*n,u=({min:e,max:t,value:n})=>(n-e)/(t-e),g={37:-1,38:1,39:1,40:-1},h=e=>t=>{const n=g[t.keyCode]??0;n&&(t.preventDefault(),e({type:"STEPS",direction:n}))},p=(e,t)=>{const{centerX:n,centerY:a}=(e=>{const t=e.getBoundingClientRect();return{centerX:t.x+e.clientWidth/2,centerY:t.y+e.clientHeight/2}})(e),r=t.clientX-n,s=t.clientY-a,o=180*Math.atan2(s,r)/Math.PI+90,i=o<0?o+360:o;return{mouseX:r,mouseY:s,mouseRadius:Math.sqrt(r*r+s*s),mouseAngle:i}},m=e=>(t,n)=>{switch(n.type){case"START":return((e,t,n)=>{const a=e.mouseAngle,r=e.percentage,s=i({previousMouseAngle:null,previousPercentage:null,...e,mouseAngle:a,percentage:r,...t}),o=t.steps||e.steps,c=l(s,e,o),u=d({...e,...c});return n.onStart(),n.onInteractiveChange(u),e.tracking&&n.onChange(u),{...e,isActive:!0,...c,startPercentage:e.percentage,startValue:e.value,value:u}})(t,n,e);case"MOVE":return((e,t,n)=>{const a=e.mouseAngle,r=e.percentage,s=i({previousMouseAngle:e.mouseAngle,previousPercentage:e.percentage,...e,mouseAngle:a,percentage:r,...t}),o=t.steps||e.steps,c=l(s,e,o),u=d({...e,...c});return n.onInteractiveChange(u),e.tracking&&n.onChange(u),{...e,...c,value:u}})(t,n,e);case"STOP":return((e,t,n)=>(null!==e.value&&(e.tracking||n.onChange(e.value)),n.onEnd(),{...e,isActive:!1,value:e.value,percentage:e.percentage,startPercentage:void 0,startValue:void 0}))(t,0,e);case"CANCEL":return((e,t,n)=>{const a=e.startPercentage,r=e.startValue;return n.onEnd(),e.tracking&&n.onChange(r),{...e,isActive:!1,value:r,percentage:a,startPercentage:void 0,startValue:void 0}})(t,0,e);case"STEPS":return((e,t,n)=>{if(void 0===t.direction)throw Error("Missing direction from Steps action");if(null===e.value)return e;const a=s(e.min,e.max,e.value+1*t.direction);return n.onChange(a),{...e,value:a,percentage:u({...e,value:a})}})(t,n,e);default:return{...t,isActive:!1,value:t.value}}},v=({min:e,max:t,multiRotation:n,initialValue:a,angleOffset:s=0,angleRange:o=360,size:i,steps:l,onChange:c,onInteractiveChange:d,interactiveHook:u,onStart:g,onEnd:v,readOnly:x,tracking:f,useMouseWheel:y})=>{const j=(0,r.useRef)(null),b=(0,r.useRef)(null),k={onChange:c,onInteractiveChange:d,onStart:g,onEnd:v},[{percentage:w,value:$},A]=(0,r.useReducer)(m(k),{isActive:!1,min:e,max:t,multiRotation:n,angleOffset:s,angleRange:o,mouseAngle:null,percentage:a?(a-e)/(t-e):0,value:a||0,svg:j,tracking:f,container:b,size:i,steps:l});return(0,r.useEffect)((({container:e,dispatch:t,readOnly:n,useMouseWheel:a,interactiveHook:r})=>()=>{if(n)return;const s=e.current,o=Object(),i=(e,t)=>{let n={};if(r){const a={ctrlKey:t.ctrlKey,altKey:t.altKey,metaKey:t.metaKey,shiftKey:t.shiftKey,...e};n=r(a)}return n},l=e=>{if("mouse"===e.pointerType&&0!==e.button)return;const n=p(s,e),a=i(n,e);a.readOnly||(e.preventDefault(),e.stopPropagation(),window.PointerEvent?(o.capturedPointerId=e.pointerId,s.setPointerCapture(o.capturedPointerId),s.addEventListener("pointermove",d),s.addEventListener("pointerup",u),s.addEventListener("pointercancel",g)):(window.addEventListener("mousemove",d),window.addEventListener("mouseup",u),o.capturedWindow=!0),s.addEventListener("contextmenu",h),o.capturedContextMenu=!0,t({type:"START",...n,...a}))},c=()=>{void 0!==o.capturedPointerId&&(s.releasePointerCapture(o.capturedPointerId),s.removeEventListener("pointermove",d),s.removeEventListener("pointerup",u),s.removeEventListener("pointercancel",g),o.capturedPointerId=void 0),o.capturedWindow&&(window.removeEventListener("mousemove",d),window.removeEventListener("mouseup",u),o.capturedWindow=!1),o.capturedContextMenu&&(s.removeEventListener("contextmenu",h),o.capturedContextMenu=!1)},d=e=>{e.preventDefault(),e.stopPropagation();const n=p(s,e),a=i(n,e);a.readOnly||t({type:"MOVE",...n,...a})},u=()=>{c(),t({type:"STOP"})},g=()=>{c(),t({type:"CANCEL"})},h=e=>(e.preventDefault(),e.stopPropagation(),c(),t({type:"CANCEL"}),!1),m=a?(e=>t=>{const n=t.deltaX<0||t.deltaY>0?1:t.deltaX>0||t.deltaY<0?-1:0;t.preventDefault(),e({type:"STEPS",direction:n})})(t):null,v=window.PointerEvent?"pointerdown":"mousedown";return s.addEventListener(v,l),m&&s.addEventListener("wheel",m),()=>{c(),s.removeEventListener(v,l),m&&s.removeEventListener("wheel",m)}})({container:b,dispatch:A,readOnly:x,useMouseWheel:y,interactiveHook:u}),[y,x]),{svg:j,container:b,percentage:w,value:$,onKeyDown:h(A)}},x=(e,t,n)=>({x:e+t*Math.cos(n),y:e+t*Math.sin(n)}),f=e=>Math.PI*e/180,y=({color:e,percentage:t,percentageFrom:n=null,percentageTo:r=null,...s})=>{let o,i;if(null!==n&&null!==r?(o=n,i=r):null!==n?(o=n,i=t):null!==r?(o=t,i=r):(o=0,i=t),null===o||null===i)return(0,a.jsx)(a.Fragment,{});const l=(({percentageFrom:e,percentageTo:t,angleOffset:n,angleRange:a,arcWidth:r,radius:s,center:o})=>{const i=(e=>e>=360?359.999:e<=-360?-359.999:e)(a*(t-e)),l=n-90+a*e,c=s-r,d=f(l),u=f(l+i),g=Math.abs(i)<180?0:1,h=i>=0?1:0,p=x(o,s,d),m=x(o,s,u),v=x(o,c,u),y=x(o,c,d);return`M${p.x},${p.y} A${s},${s} 0 ${g} ${h} ${m.x},${m.y}L${v.x},${v.y} A${c},${c} 0 ${g} ${1-h} ${y.x},${y.y} L${p.x},${p.y}`})({...s,percentageFrom:o,percentageTo:i});return(0,a.jsx)("g",{children:(0,a.jsx)("path",{d:l,style:{fill:e}})})},j=({percentage:e,color:t,background:n,...r})=>(0,a.jsxs)("g",{children:[n&&(0,a.jsx)(y,{percentage:e,percentageFrom:e,percentageTo:1,color:n,...r}),(0,a.jsx)(y,{percentage:e,percentageFrom:0,percentageTo:e,color:t,...r})]}),b=({type:e,width:t,height:n,color:r,className:s})=>{switch(e){case"rect":return(0,a.jsx)("rect",{x:.5*-t,width:t,height:n,fill:r,className:s});case"circle":return(0,a.jsx)("circle",{r:t,fill:r,className:s});case"triangle":const e=`M 0,0 L ${t/2},${n} L ${-t/2},${n} z`;return(0,a.jsx)("path",{d:e,fill:r,className:s})}return(0,a.jsx)(a.Fragment,{})},k=({children:e,width:t,height:n=t,angleOffset:s,angleRange:o,percentage:i,useRotation:l=!0,radius:c,center:d,type:u,color:g,className:h})=>{if(null===i)return(0,a.jsx)(a.Fragment,{});let p;if(l)p=`rotate(${s+o*i} ${d} ${d})\n\t\t\t\t\ttranslate( ${d} ${d-c-n})`;else{const e=(s+o*i-90)*Math.PI/180;p=`translate(${d+c*Math.cos(e)} ${d+c*Math.sin(e)})`}return(0,a.jsxs)("g",{transform:p,children:[e&&r.Children.map(e,e=>(0,r.isValidElement)(e)?r.cloneElement(e,{width:t??0,height:n??0,percentage:i}):e),u&&(0,a.jsx)(b,{type:u,width:t,height:n,color:g,className:h})]})},w=({angleRange:e,steps:t,type:n="rect",radius:r,tickWidth:s,tickHeight:o,angleOffset:i,center:l,color:c,activeColor:d=c,className:u,activeClassName:g=u,fn:h,percentage:p})=>{const m=e/t,v=t+(360===e?0:1),x=l-s/2,f=l-r;if(null===p)return(0,a.jsx)(a.Fragment,{});const y=Math.round((v-1)*p);const j="circle"===n?(({tickWidth:e,translateX:t,translateY:n,angleOffset:r,stepSize:s,center:o,color:i,active:l,activeColor:c,activeClassName:d,className:u})=>(g,h)=>(0,a.jsx)("circle",{r:e,className:h===l?d:u,fill:h===l?c:i,stroke:"none",transform:`\n        rotate(${r+s*h} ${o} ${o}) \n        translate(${t} ${n})\n        `},h))({tickWidth:s,translateX:x,translateY:f,center:l,angleOffset:i,stepSize:m,color:c,active:y,activeColor:d,className:u,activeClassName:g}):"rect"!==n||h?h?null===p?(0,a.jsx)(a.Fragment,{}):(({fn:e,...t})=>(n,a)=>e({...t,i:a}))({fn:h,tickWidth:s,tickHeight:o,translateX:x,translateY:f,angleOffset:i,stepSize:m,center:l,color:c,active:y,activeColor:d,className:u,activeClassName:g,steps:t,percentage:p}):void 0:(({tickWidth:e,tickHeight:t,translateX:n,translateY:r,angleOffset:s,stepSize:o,center:i,color:l,active:c,activeColor:d,activeClassName:u,className:g})=>(h,p)=>(0,a.jsx)("rect",{className:p===c?u:g,fill:p===c?d:l,stroke:"none",width:e,height:t,transform:`\n        rotate(${s+o*p} ${i} ${i}) \n        translate(${n} ${r})\n        `},p))({tickWidth:s,tickHeight:o,translateX:x,translateY:f,angleOffset:i,stepSize:m,center:l,color:c,active:y,activeColor:d,className:u,activeClassName:g});return(0,a.jsx)("g",{children:Array.from({length:v},j)})},$=({value:e,size:t,decimalPlace:n=0,className:r,marginBottom:s=0})=>{if(null==e)return(0,a.jsx)(a.Fragment,{});let o=e.toFixed(n);return o.startsWith("-")&&0===Number.parseFloat(o)&&(o=o.slice(1)),(0,a.jsx)("text",{style:{userSelect:"none"},x:"50%",textAnchor:"middle",className:r,y:(t??0)-s,children:o})},A=(e,t,n)=>({x:e+t*Math.cos(n),y:e+t*Math.sin(n)}),C=e=>Math.PI*e/180;const M=({color:e,percentage:t,percentageFrom:n=null,radiusFrom:r=null,percentageTo:s=null,radiusTo:o=null,...i})=>{let l,c;if(null!==n&&null!==s?(l=n,c=s):null!==n?(l=n,c=t):null!==s?(l=t,c=s):(l=0,c=t),null===r||null===o)return(0,a.jsx)(a.Fragment,{});if(null===l||null===c)return(0,a.jsx)(a.Fragment,{});const d=(({percentageFrom:e,percentageTo:t,angleOffset:n,angleRange:a,arcWidth:r,outerRadiusFrom:s,outerRadiusTo:o,center:i})=>{const[l,c,d,u]=function(e,t,n,a){return e<=n?[e,t,n,a]:[n,a,e,t]}(e,s,t,o),g=a*(d-l),h=n-90+a*l,p=C(h),m=C(h+g),v=4*Math.ceil(d-l);let x="",f="",y="",j="";for(let b=0;b<=v;b++){const e=b/v,t=c+(u-c)*e,n=t-r,a=p+(m-p)*e,s=180*a/Math.PI*e,o=A(i,t,a),l=A(i,n,a);0===b?f=`${o.x},${o.y} `:x+=`${t},${t} ${s} 0 1 ${o.x},${o.y} `,b===v?j=`${l.x},${l.y} `:y=`${n},${n} ${s} 0 0 ${l.x},${l.y} `+y}return`M ${f}A ${x}L ${j}A ${y}z`})({percentageFrom:l,percentageTo:c,outerRadiusFrom:r,outerRadiusTo:o,...i});return(0,a.jsx)("g",{children:(0,a.jsx)("path",{d:d,style:{fill:e}})})},R=({label:e,angleRange:t,angleOffset:n,percentage:r,center:s,radius:o=0,className:i,style:l={},userSelect:c="none"})=>{if(!e||null===r)return(0,a.jsx)(a.Fragment,{});const d=((e,t,n)=>{const a=n*Math.PI/180;return{x:e+t*Math.cos(a),y:e+t*Math.sin(a)}})(s,o,n+90+t*r);return(0,a.jsx)("g",{transform:`translate( ${s-d.x} ${s-d.y})`,children:(0,a.jsx)("text",{style:{userSelect:c,...l},x:"50%",y:"50%",textAnchor:"middle",className:i,dominantBaseline:"middle",children:e})})},E=({min:e,max:t,value:n,multiRotation:s=!1,angleOffset:o=0,angleRange:i=360,size:l,onChange:c=()=>{},onInteractiveChange:d=()=>{},interactiveHook:u,onStart:g=()=>{},onEnd:h=()=>{},children:p,steps:m,snap:x=!1,tracking:f=!0,readOnly:b=!1,useMouseWheel:A=!0,ariaValueText:C,ariaLabelledBy:E,className:O})=>{const{percentage:N,value:T,svg:P,container:S,onKeyDown:F}=v({min:e,max:t,multiRotation:s,initialValue:n,angleOffset:o,angleRange:i,size:l,steps:x?m:void 0,onChange:c,onInteractiveChange:d,interactiveHook:u,useMouseWheel:A,readOnly:b,tracking:f,onStart:g,onEnd:h});return(0,a.jsx)("div",{ref:S,tabIndex:"0",style:{outline:"none",width:l,height:l},"aria-valuemax":t,"aria-valuemin":e,"aria-valuenow":T,"aria-valuetext":C,"aria-labelledby":E,onKeyDown:b?void 0:F,className:O,children:(0,a.jsx)("svg",{width:l,height:l,ref:P,children:r.Children.map(p,e=>(0,r.isValidElement)(e)&&(({type:e})=>e===j||e===k||e===w||e===$||e===y||e===M||e===R)(e)?r.cloneElement(e,{percentage:N,size:l,value:T,angleOffset:o,angleRange:i,radius:l/2,center:l/2,steps:m,...e.props}):e)})})}},3943(e,t,n){n.d(t,{R:()=>o,x:()=>i});var a=n(2128);const r={},s=a.createContext(r);function o(e){const t=a.useContext(s);return a.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),a.createElement(s.Provider,{value:t},e.children)}}}]);