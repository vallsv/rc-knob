"use strict";(globalThis.webpackChunkrc_knob_docs=globalThis.webpackChunkrc_knob_docs||[]).push([[377],{2772(e,t,n){n.d(t,{A:()=>a});const a={primary:"#FC5A96",secondary:"#180094",shadow:"#CCCCCC"}},3045(e,t,n){n.d(t,{An:()=>M,FE:()=>$,JU:()=>E,N6:()=>R,Q6:()=>y,WT:()=>b,gm:()=>C,l5:()=>k});var a=n(7900),r=n(2128);const i=(e,t,n)=>Math.max(e,Math.min(t,n)),s=({mouseAngle:e,angleOffset:t,angleRange:n})=>i(0,1,.5+((e-(t+.5*n)+900)%360-180)/n),o=({mouseAngle:e,multiRotation:t,angleOffset:n,angleRange:a,percentage:r,previousPercentage:i,previousMouseAngle:o})=>{if(null!==o){const r=(e-o)%360,s=r>180?-(360-r):r<-180?360+r:r;if(s>=120||s<=-120)return{updated:!1,mouseAngle:o,percentage:i};const l=i+s/a;if(!t&&(l<0||l>1)){return{updated:!0,mouseAngle:l<0?n:(n+a+720)%360,percentage:l<0?0:1}}return{updated:!0,mouseAngle:e,percentage:l}}if(t){const t=(s({angleOffset:n,angleRange:a,mouseAngle:e})+1-r%1)%1;return{updated:!0,mouseAngle:e,percentage:r+(t>.5?t-1:t)}}return{updated:!0,mouseAngle:e,percentage:s({angleOffset:n,angleRange:a,mouseAngle:e})}},l=(e,t,n)=>{if(!e.updated||!n)return e;const a=c(e.percentage,n),r=(t.angleOffset+t.angleRange*a)%360;return{...e,percentage:a,mouseAngle:r<0?r+360:r}},c=(e,t)=>{if(0===e)return 0;const n=Math.sign(e),a=Math.abs(e),r=1/t;return n*(a-.5*r)+n*(r-(a+.5*r)%r)},u=({min:e,max:t,percentage:n})=>e+(t-e)*n,d=({min:e,max:t,value:n})=>(n-e)/(t-e),g={37:-1,38:1,39:1,40:-1},h=e=>t=>{const n=g[t.keyCode]??0;n&&(t.preventDefault(),e({type:"STEPS",direction:n}))},p=(e,t)=>{const{centerX:n,centerY:a}=(e=>{const t=e.getBoundingClientRect();return{centerX:t.x+e.clientWidth/2,centerY:t.y+e.clientHeight/2}})(e),r=t.clientX-n,i=t.clientY-a,s=180*Math.atan2(i,r)/Math.PI+90,o=s<0?s+360:s;return{mouseX:r,mouseY:i,mouseRadius:Math.sqrt(r*r+i*i),mouseAngle:o}},m=e=>(t,n)=>{switch(n.type){case"START":return((e,t,n)=>{const a=e.mouseAngle,r=e.percentage,i=o({previousMouseAngle:null,previousPercentage:null,...e,mouseAngle:a,percentage:r,...t}),s=t.steps||e.steps,c=l(i,e,s),d=u({...e,...c});return n.onStart(),n.onInteractiveChange(d),e.tracking&&n.onChange(d),{...e,isActive:!0,...c,startPercentage:e.percentage,startValue:e.value,value:d}})(t,n,e);case"MOVE":return((e,t,n)=>{const a=e.mouseAngle,r=e.percentage,i=o({previousMouseAngle:e.mouseAngle,previousPercentage:e.percentage,...e,mouseAngle:a,percentage:r,...t}),s=t.steps||e.steps,c=l(i,e,s),d=u({...e,...c});return n.onInteractiveChange(d),e.tracking&&n.onChange(d),{...e,...c,value:d}})(t,n,e);case"STOP":return((e,t,n)=>(null!==e.value&&(e.tracking||n.onChange(e.value)),n.onEnd(),{...e,isActive:!1,value:e.value,percentage:e.percentage,startPercentage:void 0,startValue:void 0}))(t,0,e);case"CANCEL":return((e,t,n)=>{const a=e.startPercentage,r=e.startValue;return n.onEnd(),e.tracking&&n.onChange(r),{...e,isActive:!1,value:r,percentage:a,startPercentage:void 0,startValue:void 0}})(t,0,e);case"STEPS":return((e,t,n)=>{if(void 0===t.direction)throw Error("Missing direction from Steps action");if(null===e.value)return e;const a=i(e.min,e.max,e.value+1*t.direction);return n.onChange(a),{...e,value:a,percentage:d({...e,value:a})}})(t,n,e);default:return{...t,isActive:!1,value:t.value}}},v=({min:e,max:t,multiRotation:n,initialValue:a,angleOffset:i=0,angleRange:s=360,size:o,steps:l,onChange:c,onInteractiveChange:u,interactiveHook:d,onStart:g,onEnd:v,readOnly:f,tracking:x,useMouseWheel:y})=>{const k=(0,r.useRef)(null),j=(0,r.useRef)(null),C={onChange:c,onInteractiveChange:u,onStart:g,onEnd:v},[{percentage:$,value:b},w]=(0,r.useReducer)(m(C),{isActive:!1,min:e,max:t,multiRotation:n,angleOffset:i,angleRange:s,mouseAngle:null,percentage:a?(a-e)/(t-e):0,value:a||0,svg:k,tracking:x,container:j,size:o,steps:l});return(0,r.useEffect)((({container:e,dispatch:t,readOnly:n,useMouseWheel:a,interactiveHook:r})=>()=>{if(n)return;const i=e.current,s=Object(),o=(e,t)=>{let n={};if(r){const a={ctrlKey:t.ctrlKey,altKey:t.altKey,metaKey:t.metaKey,shiftKey:t.shiftKey,...e};n=r(a)}return n},l=e=>{if("mouse"===e.pointerType&&0!==e.button)return;const n=p(i,e),a=o(n,e);a.readOnly||(e.preventDefault(),e.stopPropagation(),window.PointerEvent?(s.capturedPointerId=e.pointerId,i.setPointerCapture(s.capturedPointerId),i.addEventListener("pointermove",u),i.addEventListener("pointerup",d),i.addEventListener("pointercancel",g)):(window.addEventListener("mousemove",u),window.addEventListener("mouseup",d),s.capturedWindow=!0),i.addEventListener("contextmenu",h),s.capturedContextMenu=!0,t({type:"START",...n,...a}))},c=()=>{void 0!==s.capturedPointerId&&(i.releasePointerCapture(s.capturedPointerId),i.removeEventListener("pointermove",u),i.removeEventListener("pointerup",d),i.removeEventListener("pointercancel",g),s.capturedPointerId=void 0),s.capturedWindow&&(window.removeEventListener("mousemove",u),window.removeEventListener("mouseup",d),s.capturedWindow=!1),s.capturedContextMenu&&(i.removeEventListener("contextmenu",h),s.capturedContextMenu=!1)},u=e=>{e.preventDefault(),e.stopPropagation();const n=p(i,e),a=o(n,e);a.readOnly||t({type:"MOVE",...n,...a})},d=()=>{c(),t({type:"STOP"})},g=()=>{c(),t({type:"CANCEL"})},h=e=>(e.preventDefault(),e.stopPropagation(),c(),t({type:"CANCEL"}),!1),m=a?(e=>t=>{const n=t.deltaX<0||t.deltaY>0?1:t.deltaX>0||t.deltaY<0?-1:0;t.preventDefault(),e({type:"STEPS",direction:n})})(t):null,v=window.PointerEvent?"pointerdown":"mousedown";return i.addEventListener(v,l),m&&i.addEventListener("wheel",m),()=>{c(),i.removeEventListener(v,l),m&&i.removeEventListener("wheel",m)}})({container:j,dispatch:w,readOnly:f,useMouseWheel:y,interactiveHook:d}),[y,f]),{svg:k,container:j,percentage:$,value:b,onKeyDown:h(w)}},f=(e,t,n)=>({x:e+t*Math.cos(n),y:e+t*Math.sin(n)}),x=e=>Math.PI*e/180,y=({color:e,percentage:t,percentageFrom:n=null,percentageTo:r=null,...i})=>{let s,o;if(null!==n&&null!==r?(s=n,o=r):null!==n?(s=n,o=t):null!==r?(s=t,o=r):(s=0,o=t),null===s||null===o)return(0,a.jsx)(a.Fragment,{});const l=(({percentageFrom:e,percentageTo:t,angleOffset:n,angleRange:a,arcWidth:r,radius:i,center:s})=>{const o=(e=>e>=360?359.999:e<=-360?-359.999:e)(a*(t-e)),l=n-90+a*e,c=i-r,u=x(l),d=x(l+o),g=Math.abs(o)<180?0:1,h=o>=0?1:0,p=f(s,i,u),m=f(s,i,d),v=f(s,c,d),y=f(s,c,u);return`M${p.x},${p.y} A${i},${i} 0 ${g} ${h} ${m.x},${m.y}L${v.x},${v.y} A${c},${c} 0 ${g} ${1-h} ${y.x},${y.y} L${p.x},${p.y}`})({...i,percentageFrom:s,percentageTo:o});return(0,a.jsx)("g",{children:(0,a.jsx)("path",{d:l,style:{fill:e}})})},k=({percentage:e,color:t,background:n,...r})=>(0,a.jsxs)("g",{children:[n&&(0,a.jsx)(y,{percentage:e,percentageFrom:e,percentageTo:1,color:n,...r}),(0,a.jsx)(y,{percentage:e,percentageFrom:0,percentageTo:e,color:t,...r})]}),j=({type:e,width:t,height:n,color:r,className:i})=>{switch(e){case"rect":return(0,a.jsx)("rect",{x:.5*-t,width:t,height:n,fill:r,className:i});case"circle":return(0,a.jsx)("circle",{r:t,fill:r,className:i});case"triangle":const e=`M 0,0 L ${t/2},${n} L ${-t/2},${n} z`;return(0,a.jsx)("path",{d:e,fill:r,className:i})}return(0,a.jsx)(a.Fragment,{})},C=({children:e,width:t,height:n=t,angleOffset:i,angleRange:s,percentage:o,useRotation:l=!0,radius:c,center:u,type:d,color:g,className:h})=>{if(null===o)return(0,a.jsx)(a.Fragment,{});let p;if(l)p=`rotate(${i+s*o} ${u} ${u})\n\t\t\t\t\ttranslate( ${u} ${u-c-n})`;else{const e=(i+s*o-90)*Math.PI/180;p=`translate(${u+c*Math.cos(e)} ${u+c*Math.sin(e)})`}return(0,a.jsxs)("g",{transform:p,children:[e&&r.Children.map(e,e=>(0,r.isValidElement)(e)?r.cloneElement(e,{width:t??0,height:n??0,percentage:o}):e),d&&(0,a.jsx)(j,{type:d,width:t,height:n,color:g,className:h})]})},$=({angleRange:e,steps:t,type:n="rect",radius:r,tickWidth:i,tickHeight:s,angleOffset:o,center:l,color:c,activeColor:u=c,className:d,activeClassName:g=d,fn:h,percentage:p})=>{const m=e/t,v=t+(360===e?0:1),f=l-i/2,x=l-r;if(null===p)return(0,a.jsx)(a.Fragment,{});const y=Math.round((v-1)*p);const k="circle"===n?(({tickWidth:e,translateX:t,translateY:n,angleOffset:r,stepSize:i,center:s,color:o,active:l,activeColor:c,activeClassName:u,className:d})=>(g,h)=>(0,a.jsx)("circle",{r:e,className:h===l?u:d,fill:h===l?c:o,stroke:"none",transform:`\n        rotate(${r+i*h} ${s} ${s}) \n        translate(${t} ${n})\n        `},h))({tickWidth:i,translateX:f,translateY:x,center:l,angleOffset:o,stepSize:m,color:c,active:y,activeColor:u,className:d,activeClassName:g}):"rect"!==n||h?h?null===p?(0,a.jsx)(a.Fragment,{}):(({fn:e,...t})=>(n,a)=>e({...t,i:a}))({fn:h,tickWidth:i,tickHeight:s,translateX:f,translateY:x,angleOffset:o,stepSize:m,center:l,color:c,active:y,activeColor:u,className:d,activeClassName:g,steps:t,percentage:p}):void 0:(({tickWidth:e,tickHeight:t,translateX:n,translateY:r,angleOffset:i,stepSize:s,center:o,color:l,active:c,activeColor:u,activeClassName:d,className:g})=>(h,p)=>(0,a.jsx)("rect",{className:p===c?d:g,fill:p===c?u:l,stroke:"none",width:e,height:t,transform:`\n        rotate(${i+s*p} ${o} ${o}) \n        translate(${n} ${r})\n        `},p))({tickWidth:i,tickHeight:s,translateX:f,translateY:x,angleOffset:o,stepSize:m,center:l,color:c,active:y,activeColor:u,className:d,activeClassName:g});return(0,a.jsx)("g",{children:Array.from({length:v},k)})},b=({value:e,size:t,decimalPlace:n=0,className:r,marginBottom:i=0})=>{if(null==e)return(0,a.jsx)(a.Fragment,{});let s=e.toFixed(n);return s.startsWith("-")&&0===Number.parseFloat(s)&&(s=s.slice(1)),(0,a.jsx)("text",{style:{userSelect:"none"},x:"50%",textAnchor:"middle",className:r,y:(t??0)-i,children:s})},w=(e,t,n)=>({x:e+t*Math.cos(n),y:e+t*Math.sin(n)}),A=e=>Math.PI*e/180;const M=({color:e,percentage:t,percentageFrom:n=null,radiusFrom:r=null,percentageTo:i=null,radiusTo:s=null,...o})=>{let l,c;if(null!==n&&null!==i?(l=n,c=i):null!==n?(l=n,c=t):null!==i?(l=t,c=i):(l=0,c=t),null===r||null===s)return(0,a.jsx)(a.Fragment,{});if(null===l||null===c)return(0,a.jsx)(a.Fragment,{});const u=(({percentageFrom:e,percentageTo:t,angleOffset:n,angleRange:a,arcWidth:r,outerRadiusFrom:i,outerRadiusTo:s,center:o})=>{const[l,c,u,d]=function(e,t,n,a){return e<=n?[e,t,n,a]:[n,a,e,t]}(e,i,t,s),g=a*(u-l),h=n-90+a*l,p=A(h),m=A(h+g),v=4*Math.ceil(u-l);let f="",x="",y="",k="";for(let j=0;j<=v;j++){const e=j/v,t=c+(d-c)*e,n=t-r,a=p+(m-p)*e,i=180*a/Math.PI*e,s=w(o,t,a),l=w(o,n,a);0===j?x=`${s.x},${s.y} `:f+=`${t},${t} ${i} 0 1 ${s.x},${s.y} `,j===v?k=`${l.x},${l.y} `:y=`${n},${n} ${i} 0 0 ${l.x},${l.y} `+y}return`M ${x}A ${f}L ${k}A ${y}z`})({percentageFrom:l,percentageTo:c,outerRadiusFrom:r,outerRadiusTo:s,...o});return(0,a.jsx)("g",{children:(0,a.jsx)("path",{d:u,style:{fill:e}})})},E=({label:e,angleRange:t,angleOffset:n,percentage:r,center:i,radius:s=0,className:o,style:l={},userSelect:c="none"})=>{if(!e||null===r)return(0,a.jsx)(a.Fragment,{});const u=((e,t,n)=>{const a=n*Math.PI/180;return{x:e+t*Math.cos(a),y:e+t*Math.sin(a)}})(i,s,n+90+t*r);return(0,a.jsx)("g",{transform:`translate( ${i-u.x} ${i-u.y})`,children:(0,a.jsx)("text",{style:{userSelect:c,...l},x:"50%",y:"50%",textAnchor:"middle",className:o,dominantBaseline:"middle",children:e})})},R=({min:e,max:t,value:n,multiRotation:i=!1,angleOffset:s=0,angleRange:o=360,size:l,onChange:c=()=>{},onInteractiveChange:u=()=>{},interactiveHook:d,onStart:g=()=>{},onEnd:h=()=>{},children:p,steps:m,snap:f=!1,tracking:x=!0,readOnly:j=!1,useMouseWheel:w=!0,ariaValueText:A,ariaLabelledBy:R,className:O})=>{const{percentage:N,value:P,svg:I,container:S,onKeyDown:T}=v({min:e,max:t,multiRotation:i,initialValue:n,angleOffset:s,angleRange:o,size:l,steps:f?m:void 0,onChange:c,onInteractiveChange:u,interactiveHook:d,useMouseWheel:w,readOnly:j,tracking:x,onStart:g,onEnd:h});return(0,a.jsx)("div",{ref:S,tabIndex:"0",style:{outline:"none",width:l,height:l},"aria-valuemax":t,"aria-valuemin":e,"aria-valuenow":P,"aria-valuetext":A,"aria-labelledby":R,onKeyDown:j?void 0:T,className:O,children:(0,a.jsx)("svg",{width:l,height:l,ref:I,children:r.Children.map(p,e=>(0,r.isValidElement)(e)&&(({type:e})=>e===k||e===C||e===$||e===b||e===y||e===M||e===E)(e)?r.cloneElement(e,{percentage:N,size:l,value:P,angleOffset:s,angleRange:o,radius:l/2,center:l/2,steps:m,...e.props}):e)})})}},3943(e,t,n){n.d(t,{R:()=>s,x:()=>o});var a=n(2128);const r={},i=a.createContext(r);function s(e){const t=a.useContext(i);return a.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),a.createElement(i.Provider,{value:t},e.children)}},9446(e,t,n){n.r(t),n.d(t,{assets:()=>u,contentTitle:()=>c,default:()=>p,frontMatter:()=>l,interactiveHook:()=>d,metadata:()=>a,toc:()=>g});const a=JSON.parse('{"id":"user_interaction","title":"User interaction","description":"Few properties can be used to reach and tune the knob with user interaction.","source":"@site/docs/2_user_interaction.mdx","sourceDirName":".","slug":"/user_interaction","permalink":"/rc-knob/user_interaction","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2,"title":"User interaction"},"sidebar":"tutorialSidebar","previous":{"title":"Base components","permalink":"/rc-knob/base_components"},"next":{"title":"Examples","permalink":"/rc-knob/category/examples"}}');var r=n(7900),i=n(3943),s=n(2772),o=n(3045);const l={sidebar_position:2,title:"User interaction"},c=void 0,u={},d=e=>e.mouseRadius<20?{readOnly:!0}:e.mouseRadius<50||e.ctrlKey?{steps:8}:{},g=[{value:"Mouse callbacks",id:"mouse-callbacks",level:2},{value:"Disable user interaction",id:"disable-user-interaction",level:2},{value:"Disable mouse wheel",id:"disable-mouse-wheel",level:2},{value:"Disable tracking",id:"disable-tracking",level:2},{value:"Interaction hook",id:"interaction-hook",level:2}];function h(e){const t={code:"code",h2:"h2",p:"p",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.p,{children:"Few properties can be used to reach and tune the knob with user interaction."}),"\n",(0,r.jsx)(t.h2,{id:"mouse-callbacks",children:"Mouse callbacks"}),"\n",(0,r.jsxs)(o.N6,{value:0,size:100,angleOffset:220,angleRange:280,min:0,max:100,onChange:e=>console.log(e),onStart:e=>console.log("Interaction started"),onEnd:e=>console.log("Interaction ended"),children:[(0,r.jsx)("circle",{r:"40",cx:"50",cy:"50",fill:s.A.primary}),(0,r.jsx)(o.gm,{width:3,height:30,radius:10,type:"rect",color:"#fff"})]}),"\n",(0,r.jsx)(t.h2,{id:"disable-user-interaction",children:"Disable user interaction"}),"\n",(0,r.jsxs)(o.N6,{value:0,size:100,angleOffset:220,angleRange:280,min:0,max:100,onChange:e=>console.log(e),onStart:e=>console.log("Interaction started"),onEnd:e=>console.log("Interaction ended"),readOnly:!0,children:[(0,r.jsx)("circle",{r:"40",cx:"50",cy:"50",fill:s.A.primary}),(0,r.jsx)(o.gm,{width:3,height:30,radius:10,type:"rect",color:"#fff"})]}),"\n",(0,r.jsx)(t.h2,{id:"disable-mouse-wheel",children:"Disable mouse wheel"}),"\n",(0,r.jsxs)(o.N6,{value:0,size:100,angleOffset:220,angleRange:280,min:0,max:100,useMouseWheel:!1,children:[(0,r.jsx)("circle",{r:"40",cx:"50",cy:"50",fill:s.A.primary}),(0,r.jsx)(o.gm,{width:3,height:30,radius:10,type:"rect",color:"#fff"})]}),"\n",(0,r.jsx)(t.h2,{id:"disable-tracking",children:"Disable tracking"}),"\n",(0,r.jsxs)(t.p,{children:["The mouse tracking during dragging can be disabled with ",(0,r.jsx)(t.code,{children:"tracking=false"}),".\nAs result ",(0,r.jsx)(t.code,{children:"onChange"})," is only called at the end of the interaction.\nAnd this interaction can be cancelled with mouse right button."]}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.code,{children:"onInteractiveChange"})," can still be used to follow the interaction."]}),"\n",(0,r.jsxs)(o.N6,{value:0,size:100,angleOffset:220,angleRange:280,min:0,max:100,onChange:e=>console.log(e),onInteractiveChange:e=>console.log("Interactive",e),onStart:e=>console.log("Interaction started"),onEnd:e=>console.log("Interaction ended"),tracking:!1,children:[(0,r.jsx)("circle",{r:"40",cx:"50",cy:"50",fill:s.A.primary}),(0,r.jsx)(o.gm,{width:3,height:30,radius:10,type:"rect",color:"#fff"})]}),"\n",(0,r.jsx)(t.h2,{id:"interaction-hook",children:"Interaction hook"}),"\n",(0,r.jsx)(t.p,{children:"A hook is provided to change the interaction behaviour during a dragging\ninteraction."}),"\n",(0,r.jsx)(t.p,{children:"The following example inhibite the center of the knob, snap 8 location over the\nknob and provides free moving outside of the knob."}),"\n","\n",(0,r.jsxs)(o.N6,{value:0,size:100,angleOffset:220,angleRange:280,min:0,max:100,interactiveHook:d,children:[(0,r.jsx)("circle",{r:"40",cx:"50",cy:"50",fill:s.A.primary}),(0,r.jsx)(o.gm,{width:3,height:30,radius:10,type:"rect",color:"#fff"})]})]})}function p(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}}}]);